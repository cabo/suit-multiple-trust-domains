<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SUIT Manifest Extensions for Multiple Trust Domains</title>
<meta content="Brendan Moran" name="author">
<meta content="Ken Takayama" name="author">
<meta content="
       This specification describes extensions to the SUIT Manifest format (as
defined in  ) for use in deployments with
multiple trust domains. A device has more than one trust domain when it
enables delegation of different rights to mutually distrusting entities
for use for different purposes or Components in the context of firmware
or software update. 
    " name="description">
<meta content="xml2rfc 3.17.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-suit-trust-domains-07" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.17.1
    Python 3.11.9
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.28.2
    setuptools 69.2.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-ietf-suit-trust-domains.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SUIT Trust Domains</td>
<td class="right">July 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Moran &amp; Takayama</td>
<td class="center">Expires 7 January 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">SUIT</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-suit-trust-domains-07</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-07-06" class="published">6 July 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-01-07">7 January 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">B. Moran</div>
<div class="org">Arm Limited</div>
</div>
<div class="author">
      <div class="author-name">K. Takayama</div>
<div class="org">SECOM CO., LTD.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SUIT Manifest Extensions for Multiple Trust Domains</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification describes extensions to the SUIT Manifest format (as
defined in <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) for use in deployments with
multiple trust domains. A device has more than one trust domain when it
enables delegation of different rights to mutually distrusting entities
for use for different purposes or Components in the context of firmware
or software update.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 7 January 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-changes-to-suit-workflow-mo" class="internal xref">Changes to SUIT Workflow Model</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-changes-to-manifest-metadat" class="internal xref">Changes to Manifest Metadata Structure</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dependencies" class="internal xref">Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-changes-to-required-checks" class="internal xref">Changes to Required Checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-changes-to-manifest-structu" class="internal xref">Changes to Manifest Structure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-manifest-component-id" class="internal xref">Manifest Component ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-suit_dependencies-manifest-" class="internal xref">SUIT_Dependencies Manifest Element</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-changes-to-abstract-machine" class="internal xref">Changes to Abstract Machine Description</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-processing-dependencies" class="internal xref">Processing Dependencies</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-multiple-manifest-processor" class="internal xref">Multiple Manifest Processors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-dependency-resolution" class="internal xref">Dependency Resolution</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-added-and-modified-commands" class="internal xref">Added and Modified Commands</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="auto internal xref">5.6.1</a>.  <a href="#name-suit-directive-set-paramete" class="internal xref">suit-directive-set-parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.2">
                    <p id="section-toc.1-1.5.2.6.2.2.1"><a href="#section-5.6.2" class="auto internal xref">5.6.2</a>.  <a href="#name-suit-directive-process-depe" class="internal xref">suit-directive-process-dependency</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.3">
                    <p id="section-toc.1-1.5.2.6.2.3.1"><a href="#section-5.6.3" class="auto internal xref">5.6.3</a>.  <a href="#name-suit-condition-is-dependenc" class="internal xref">suit-condition-is-dependency</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.4">
                    <p id="section-toc.1-1.5.2.6.2.4.1"><a href="#section-5.6.4" class="auto internal xref">5.6.4</a>.  <a href="#name-suit-condition-dependency-i" class="internal xref">suit-condition-dependency-integrity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.5">
                    <p id="section-toc.1-1.5.2.6.2.5.1"><a href="#section-5.6.5" class="auto internal xref">5.6.5</a>.  <a href="#name-suit-directive-unlink" class="internal xref">suit-directive-unlink</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-uninstall" class="internal xref">Uninstall</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-staging-and-installation" class="internal xref">Staging and Installation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-suit-candidate-verification" class="internal xref">suit-candidate-verification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-creating-manifests" class="internal xref">Creating Manifests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-dependency-template" class="internal xref">Dependency Template</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-integrated-dependencies" class="internal xref">Integrated Dependencies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-encrypted-manifest-template" class="internal xref">Encrypted Manifest Template</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-overriding-encryption-info-" class="internal xref">Overriding Encryption Info Template</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-operating-on-multiple-compo" class="internal xref">Operating on Multiple Components</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-suit-envelope-elements" class="internal xref">SUIT Envelope Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-suit-manifest-elements" class="internal xref">SUIT Manifest Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-suit-common-elements" class="internal xref">SUIT Common Elements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-suit-commands" class="internal xref">SUIT Commands</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-a-full-cddl" class="internal xref">A. Full CDDL</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-b-examples" class="internal xref">B. Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-example-0-process-dependenc" class="internal xref">Example 0: Process Dependency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-example-1-integrated-depend" class="internal xref">Example 1: Integrated Dependency</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Devices that go beyond single-signer update require more complex rules for deploying software updates. For example, devices may require:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-2.1">software Components from multiple software signing authorities.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.2">a mechanism to remove an unneeded Component<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.3">single-object Dependencies<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.4">a partly encrypted Manifest so that distribution does not reveal private information<a href="#section-1-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-2.5">installation performed by a different execution mode than payload fetch<a href="#section-1-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-3">Dependency Manifests enable several additional use cases. In particular, they enable two or more entities who are trusted for different privileges to coordinate. This can be used in many scenarios. For example:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">A device may contain a processor in its radio in addition to the primary processor. These two processors may have separate Software with separate signing authorities. Dependencies allow the Software for the primary processor to reference a Manifest signed by a different authority.<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.2">A network operator may wish to provide local caching of Update Payloads. The network operator overrides the URI of a Payload by providing a dependent Manifest that references the original Manifest, but replaces its URI.<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.3">A device operator provides a device with some additional configuration. The device operator wants to test their configuration with each new Software version before releasing it. The configuration is delivered as a binary in the same way as a Software Image. The device operator references the Software Manifest from the Software author in their own Manifest which also defines the configuration.<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.4">An Author wants to entrust a Distributor to provide devices with firmware decryption keys, but not permit the Distributor to sign code. Dependencies allow the Distributor to deliver a device's decryption information without also granting code signing authority.<a href="#section-1-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.5">A Trusted Application Manager (TAM) wants to distribute personalisation information to a Trusted Execution Environment in addition to a Trusted Application (TA), but does not have code signing authority. Dependencies enable the TAM to construct an update containing the personalisation information and a dependency on the TA, but leaves the TA signed by the TA's Author.<a href="#section-1-4.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-5">By using Dependencies, Components such as Software, configuration, and other Resource data authenticated by different Trust Anchors can be delivered to devices.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">These mechanisms are not part of the core Manifest specification, but they are needed for more advanced use cases, such as the architecture described in <span>[<a href="#I-D.ietf-teep-architecture" class="cite xref">I-D.ietf-teep-architecture</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This specification extends the SUIT Manifest specification (<span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>).<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Additionally, the following terminology is used throughout this document:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-3.1">SUIT: Software Update for the Internet of Things, also the IETF working group for this standard.<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.2">Payload: A piece of information to be delivered. Typically Firmware/Software, configuration, or Resource data such as text or images.<a href="#section-2-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.3">Resource: A piece of information that is used to construct a Payload.<a href="#section-2-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.4">Manifest: A Manifest is a bundle of metadata about one or more Components for a device, where to
find them, and the devices to which they apply.<a href="#section-2-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.5">Envelope: A container with the Manifest, an authentication wrapper with cryptographic information protecting the Manifest, authorization information, and severable elements (see Section 5.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>).<a href="#section-2-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.6">Update: One or more Manifests that describe one or more Payloads.<a href="#section-2-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.7">Update Authority: The owner of a cryptographic key used to sign Updates, trusted by Recipients.<a href="#section-2-3.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.8">Recipient: The system that receives and processes a Manifest.<a href="#section-2-3.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.9">Manifest Processor: A component of the Recipient that consumes Manifests and executes the Commands in the Manifest.<a href="#section-2-3.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.10">Component: An updatable logical block of the Firmware, Software, configuration, or data of the Recipient.<a href="#section-2-3.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.11">Component Set: A group of interdependent Components that must be updated simultaneously.<a href="#section-2-3.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.12">Command: A Condition or a Directive.<a href="#section-2-3.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.13">Condition: A test for a property of the Recipient or its Components.<a href="#section-2-3.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.14">Directive: An action for the Recipient to perform.<a href="#section-2-3.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.15">Trusted Invocation: A process by which a system ensures that only trusted code is executed, for example secure boot or launching a Trusted Application.<a href="#section-2-3.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.16">A/B Images: Dividing a Recipient's storage into two or more bootable Images, at different offsets, such that the active Image can write to the inactive Image(s).<a href="#section-2-3.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.17">Record: The result of a Command and any metadata about it.<a href="#section-2-3.17" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.18">Report: A list of Records.<a href="#section-2-3.18" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.19">Procedure: The process of invoking one or more sequences of Commands.<a href="#section-2-3.19" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.20">Update Procedure: A superset of Staging Procedure and Installation Procedure.<a href="#section-2-3.20" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.21">Staging Procedure: A procedure that fetches dependencies and images referenced by an Update and stores them to a Staging Area.<a href="#section-2-3.21" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.22">Installation Procedure: A procedure that installs dependencies and images stored in a Staging Area; copying (and optionally, transforming them) into an active Image storage location.<a href="#section-2-3.22" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.23">Invocation Procedure: A Procedure in which a Recipient verifies Dependencies and Images, loading Images, and invokes one or more Image.<a href="#section-2-3.23" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.24">Staging Area: A Component or group of Components that are used for transient storage of Images between fetch and installation. Images in this area are opaque, except for use by the Installation Procedure.<a href="#section-2-3.24" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.25">Software: Instructions and data that allow a Recipient to perform a useful function.<a href="#section-2-3.25" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.26">Firmware: Software that is typically changed infrequently, stored in nonvolatile memory, and small enough to apply to <span>[<a href="#RFC7228" class="cite xref">RFC7228</a>]</span> Class 0-2 devices.<a href="#section-2-3.26" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.27">Image: Information that a Recipient uses to perform its function, typically Firmware/Software, configuration, or Resource data such as text or images. Also, a Payload, once installed is an Image.<a href="#section-2-3.27" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.28">Slot: One of several possible storage locations for a given Component, typically used in A/B Image systems<a href="#section-2-3.28" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.29">Abort: An event in which the Manifest Processor immediately halts execution of the current Procedure. It creates a Record of an error Condition.<a href="#section-2-3.29" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-3.30">Trust Anchor: A Trust Anchor, as defined in <span>[<a href="#RFC6024" class="cite xref">RFC6024</a>]</span>, represents an
    authoritative entity via a public key and associated data.  The
    public key is used to verify digital signatures, and the
    associated data is used to constrain the types of information for
    which the Trust Anchor is authoritative.<a href="#section-2-3.30" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="changes-to-suit-workflow-model">
<section id="section-3">
      <h2 id="name-changes-to-suit-workflow-mo">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-changes-to-suit-workflow-mo" class="section-name selfRef">Changes to SUIT Workflow Model</a>
      </h2>
<p id="section-3-1">The use of the features presented for use with multiple trust domains requires some augmentation of the workflow presented in the SUIT Manifest specification (<span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>):<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">One additional assumption is added for the Update Procedure:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">All Dependency Manifests must be present before any Payload is fetched.<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-4">One additional assumption is added to the Invocation Procedure:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">All Dependencies must be validated prior to loading.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-6">Steps 3 and 5 are added to the expected installation workflow of a Recipient:<a href="#section-3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-7">
<li id="section-3-7.1">Verify the signature of the Manifest.<a href="#section-3-7.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.2">Verify the applicability of the Manifest.<a href="#section-3-7.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.3">Resolve Dependencies.<a href="#section-3-7.3" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.4">Fetch Payload(s).<a href="#section-3-7.4" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.5">Verify Candidate.<a href="#section-3-7.5" class="pilcrow">¶</a>
</li>
        <li id="section-3-7.6">Install Payload(s).<a href="#section-3-7.6" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-3-8">In addition, when multiple Manifests are used for an Update, each Manifest's steps occur in a lockstep fashion; all Manifests have Dependency resolution performed before any Manifest performs a Payload fetch, etc.<a href="#section-3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="metadata-structure-overview">
<section id="section-4">
      <h2 id="name-changes-to-manifest-metadat">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-changes-to-manifest-metadat" class="section-name selfRef">Changes to Manifest Metadata Structure</a>
      </h2>
<p id="section-4-1">To accommodate the additional metadata needed to enable these features, the Envelope and Manifest have several new elements added.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The Envelope gains one more elements: Integrated Dependencies. The Common metadata section in the Manifest also gains a list of Dependencies.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The new metadata structure is shown below.<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>
+-------------------------+
| Envelope                |
+-------------------------+
| Authentication Block    |
| Manifest           --------------&gt; +------------------------------+
| Severable Elements      |          | Manifest                     |
| Human-Readable Text     |          +------------------------------+
| CoSWID                  |          | Structure Version            |
| Integrated Dependencies |          | Sequence Number              |
| Integrated Payloads     |          | Reference to Full Manifest   |
+-------------------------+    +------ Common Structure             |
                               | +---- Command Sequences            |
+-------------------------+    | |   | Digests of Envelope Elements |
| Common Structure        | &lt;--+ |   +------------------------------+
+-------------------------+      |
| Dependency Indices      |      +-&gt; +-----------------------+
| Component IDs           |          | Command Sequence      |
| Common Command Sequence ---------&gt; +-----------------------+
+-------------------------+          | List of ( pairs of (  |
                                     |   * command code      |
                                     |   * argument /        |
                                     |      reporting policy |
                                     | ))                    |
                                     +-----------------------+
</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="dependencies">
<section id="section-5">
      <h2 id="name-dependencies">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dependencies" class="section-name selfRef">Dependencies</a>
      </h2>
<p id="section-5-1">A Dependency is another SUIT_Envelope that describes additional Components.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">As described in <a href="#Introduction" class="auto internal xref">Section 1</a>, Dependencies enable several common use cases.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="required-checks">
<section id="section-5.1">
        <h3 id="name-changes-to-required-checks">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-changes-to-required-checks" class="section-name selfRef">Changes to Required Checks</a>
        </h3>
<p id="section-5.1-1">This section augments the definitions in Required Checks (Section 6.2) of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">More checks are required when handling Dependencies. By default, any signature of a Dependency MUST be verified. However, there are some exceptions to this rule: where a device supports only one level of access (no ACLs defining which authorities have access to different Components/Commands/Parameters), it MAY choose to skip signature verification of Dependencies, since they are verified by digest. Where a device differentiates between trust levels, such as with an ACL, it MAY choose to defer the verification of signatures of Dependencies until the list of affected Components is known so that it can skip redundant signature verifications. For example, if a dependent's signer has access rights to all Components specified in a Dependency, then that Dependency does not require a signature verification. Similarly, if the signer of the dependent has full rights to the device, according to the ACL, then no signature verification is necessary on the Dependency.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Components that should be treated as Dependency Manifests are identified in the suit-common metadata. See <a href="#structure-change" class="auto internal xref">Section 5.2</a> for details.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">If the Manifest contains more than one Component and/or Dependency, each Command sequence MUST begin with a Set Component Index Command.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">If a Dependency is specified, then the Manifest processor MUST perform the following checks:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-6">
<li id="section-5.1-6.1">The dependent MUST populate all Command sequences for the current Procedure (Update or Invoke).<a href="#section-5.1-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-6.2">At the end of each section in the dependent: The corresponding section in each Dependency has been executed.<a href="#section-5.1-6.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.1-7">If the interpreter does not support Dependencies and a Manifest specifies a Dependency, then the interpreter MUST Abort.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">If a Recipient supports groups of interdependent Components (a Component Set), then it SHOULD verify that all Components in the Component Set are specified by a single Manifest and all its Dependencies that together:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-9">
<li id="section-5.1-9.1">have sufficient permissions imparted by their signatures<a href="#section-5.1-9.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.2">specify a digest and a Payload for every Component in the Component Set.<a href="#section-5.1-9.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.1-10">The single dependent Manifest is sometimes called a Root Manifest.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structure-change">
<section id="section-5.2">
        <h3 id="name-changes-to-manifest-structu">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-changes-to-manifest-structu" class="section-name selfRef">Changes to Manifest Structure</a>
        </h3>
<p id="section-5.2-1">This section augments the Manifest Structure (Section 8.4) in <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="manifest-id">
<section id="section-5.2.1">
          <h4 id="name-manifest-component-id">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-manifest-component-id" class="section-name selfRef">Manifest Component ID</a>
          </h4>
<p id="section-5.2.1-1">In complex systems, it may not always be clear where the Root Manifest should be stored; this is particularly complex when a system has multiple, independent Root Manifests. The Manifest Component ID resolves this contention. The manifest-component-id is intended to be used by the Root Manifest. When a Dependency Manifest also declares a Component ID, the Dependency Manifest's Component ID is overridden by the Component ID declared by the dependent.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">The following CDDL describes the Manifest Component ID:<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<div class="lang-CDDL sourcecode" id="section-5.2.1-3">
<pre>
$$SUIT_Manifest_Extensions //=
    (suit-manifest-component-id =&gt; SUIT_Component_Identifier)
</pre><a href="#section-5.2.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="SUIT_Dependencies">
<section id="section-5.2.2">
          <h4 id="name-suit_dependencies-manifest-">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-suit_dependencies-manifest-" class="section-name selfRef">SUIT_Dependencies Manifest Element</a>
          </h4>
<p id="section-5.2.2-1">The suit-common section, as described in <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>, Section 8.4.5 is extended with a map of Component indices that indicate a Dependency Manifest. The keys of the map are the Component indices and the values of the map are any extra metadata needed to describe those Dependency Manifests.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">Because some operations treat Dependency Manifests differently from other Components, it is necessary to identify them. SUIT_Dependencies identifies which Components from suit-components (see Section 8.4.5 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) are to be treated as Dependency Manifest Envelopes. SUIT_Dependencies is a map of Components, referenced by Component Index. Optionally, a Component prefix or other metadata may be delivered with the Component index. The CDDL for suit-dependencies is shown below:<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<div class="lang-CDDL sourcecode" id="section-5.2.2-3">
<pre>
$$SUIT_Common-extensions //= (
    suit-dependencies =&gt; SUIT_Dependencies
)
SUIT_Dependencies = {
    + uint =&gt; SUIT_Dependency_Metadata
}
SUIT_Dependency_Metadata = {
    ? suit-dependency-prefix =&gt; SUIT_Component_Identifier
    * $$SUIT_Dependency_Extensions
}
</pre><a href="#section-5.2.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-4">If no extended metadata is needed for an extension, SUIT_Dependency_Metadata is an empty map (this is the same encoding size as a null). SUIT_Dependencies MUST be sorted according to CBOR canonical encoding.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2-5">The Components specified by SUIT_Dependency will contain a Manifest Envelope that describes a Dependency of the current Manifest. The Manifest is identified, but the Recipient should expect an Envelope when it acquires the Dependency. This is because the Manifest is the one invariant element of the Envelope, where other elements may change by countersigning, adding authentication blocks, or severing elements.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2.2-6">When executing suit-condition-image-match over a Component that is designated in SUIT_Dependency, the digest MUST be computed over just the bstr-wrapped SUIT_Manifest contained in the Manifest Envelope designated by the Component Index. This enables a Dependency reference to uniquely identify a particular Manifest structure. This is identical to the digest that is present as the first element of the suit-authentication-block in the Dependency's Envelope. The digest is calculated over the Manifest structure to ensure that removing a signature from a Manifest does not break Dependencies due to missing signature elements. This is also necessary to support the trusted intermediary use case, where an intermediary re-signs the Manifest, removing the original signature, potentially with a different algorithm, or trading COSE_Sign for COSE_Mac.<a href="#section-5.2.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2.2-7">The suit-dependency-prefix element contains a SUIT_Component_Identifier (see Section 8.4.5.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>). This specifies the scope at which the Dependency operates. This allows the Dependency to be forwarded on to a Component that is capable of parsing its own Manifests. It also allows one Manifest to be deployed to multiple dependent Recipients without those Recipients needing consistent Component hierarchy. This element is OPTIONAL for Recipients to implement.<a href="#section-5.2.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2.2-8">A Dependency prefix can be used with a Component identifier. This allows complex systems to understand where Dependencies need to be applied. The Dependency prefix can be used in one of two ways. The first simply prepends the prefix to all Component Identifiers in the Dependency.<a href="#section-5.2.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2.2-9">A Dependency prefix can also be used to indicate when a Dependency Manifest needs to be processed by a secondary Manifest processor, as described in <a href="#hierarchical-interpreters" class="auto internal xref">Section 5.4.1</a>.<a href="#section-5.2.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="changes-to-abstract-machine-description">
<section id="section-5.3">
        <h3 id="name-changes-to-abstract-machine">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-changes-to-abstract-machine" class="section-name selfRef">Changes to Abstract Machine Description</a>
        </h3>
<p id="section-5.3-1">This section augments the Abstract Machine Description (Section 6.4) in <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>.
With the addition of Dependencies, some changes are necessary to the abstract machine, outside the typical scope of added Commands. These changes alter the behaviour of an existing Command and way that the parser processes Manifests:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1">
            <p id="section-5.3-2.1.1">Five new Commands are introduced:<a href="#section-5.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-2.1.2.1">Set Parameters<a href="#section-5.3-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.2">Process Dependency<a href="#section-5.3-2.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.3">Is Dependency<a href="#section-5.3-2.1.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.4">Dependency Integrity<a href="#section-5.3-2.1.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3-2.1.2.5">Unlink<a href="#section-5.3-2.1.2.5" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-5.3-2.2">Dependency Manifests are also Components. All Commands may target Dependency Manifests as well as Components, with one exception: process Dependency. Commands defined outside of this draft and <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span> MAY have additional restrictions.<a href="#section-5.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-2.3">Dependencies are processed in lockstep with the Root Manifest. This means that every Dependency's current Command sequence must be executed before a dependent's later Command sequence may be executed. For example, every Dependency's Dependency Resolution step MUST be executed before any dependent's Payload fetch step.<a href="#section-5.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-2.4">When a Manifest Processor supports multiple independent Components, they MAY have shared Dependencies.<a href="#section-5.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-2.5">When a Manifest Processor supports shared Dependencies, it MUST support reference counting of those Dependencies.<a href="#section-5.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-2.6">When reference counting is used, Components MUST NOT be overwritten. The Manifest Uninstall section must be called, then the component MUST be Unlinked.<a href="#section-5.3-2.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="processing-dependencies">
<section id="section-5.4">
        <h3 id="name-processing-dependencies">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-processing-dependencies" class="section-name selfRef">Processing Dependencies</a>
        </h3>
<p id="section-5.4-1">As described in <a href="#required-checks" class="auto internal xref">Section 5.1</a>, each Manifest must invoke each of its Dependencies' sections from the corresponding section of the dependent. Any changes made to Parameters by the Dependency persist in the dependent.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">When a Process Dependency Command is encountered, the Manifest processor:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-3">
<li id="section-5.4-3.1">Checks whether the map of Dependencies contains an entry for the current Component Index. If not present, it causes an immediate Abort.<a href="#section-5.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-3.2">Checks whether the Dependency has been the target of a Dependency integrity check. If not, it causes an immediate Abort.<a href="#section-5.4-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-3.3">Loads the specified Component as a Dependency Manifest Envelope.<a href="#section-5.4-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-3.4">Authenticates the Dependency Manifest.<a href="#section-5.4-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-3.5">Executes the common-sequence section of the Dependency Manifest.<a href="#section-5.4-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-3.6">Executes the section of the Dependency Manifest that corresponds to the currently executing section of the dependent.<a href="#section-5.4-3.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.4-4">If the specified Dependency does not contain the current section, Process Dependency succeeds immediately.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">The interpreter also performs the checks described in <a href="#required-checks" class="auto internal xref">Section 5.1</a> to ensure that the dependent is processing the Dependency correctly.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<div id="hierarchical-interpreters">
<section id="section-5.4.1">
          <h4 id="name-multiple-manifest-processor">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-multiple-manifest-processor" class="section-name selfRef">Multiple Manifest Processors</a>
          </h4>
<p id="section-5.4.1-1">When a system has multiple trust domains, each domain might require independent verification of authenticity or security policies. Trust domains might be divided by separation technology such as Arm TrustZone, Intel SGX, or another Trusted Execution Environment (TEE) technology. Trust domains might also be divided into separate processors and memory spaces, with a communication interface between them.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1-2">For example, an application processor may have an attached communications module that contains a processor. The communications module might require metadata signed by a specific Trust Authority for regulatory approval. This may be a different Trust Authority than the application processor.<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1-3">When there are two or more trust domains, a Manifest processor might be required in each. The first Manifest processor is the normal Manifest processor as described for the Recipient in Section 6 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>. The second Manifest processor only executes sections when the first Manifest processor requests it. An API interface is provided from the second Manifest processor to the first. This allows the first Manifest processor to request a limited set of operations from the second. These operations are limited to: setting Parameters, inserting an Envelope, and invoking a Manifest Command Sequence. The second Manifest processor declares a prefix to the first, which tells the first Manifest processor when it should delegate to the second. These rules are enforced by underlying separation of privilege infrastructure, such as TEEs, or physical separation.<a href="#section-5.4.1-3" class="pilcrow">¶</a></p>
<p id="section-5.4.1-4">When the first Manifest processor encounters a Dependency prefix, that informs the first Manifest processor that it should provide the second Manifest processor with the corresponding Dependency Envelope. This is done when the Dependency is fetched. The second Manifest processor immediately verifies any authentication information in the Dependency Envelope. When a Parameter is set for any Component that matches the prefix, this Parameter setting is passed to the second Manifest processor via an API. As the first Manifest processor works through the Procedure (set of Command sequences) it is executing, each time it sees a Process Dependency Command that is associated with the prefix declared by the second Manifest processor, it uses the API to ask the second Manifest processor to invoke that Dependency section instead.<a href="#section-5.4.1-4" class="pilcrow">¶</a></p>
<p id="section-5.4.1-5">This mechanism ensures that the two or more Manifest processors do not need to trust each other, except in a very limited case. When Parameter setting across trust domains is used, it must be very carefully considered. Only Parameters that do not have an effect on security properties should be allowed. The Dependency Manifest MAY control which Parameters are allowed to be set by using the Override Parameters Directive. The second Manifest processor MAY also control which Parameters may be set by the first Manifest processor by means of an ACL that lists the allowed Parameters. For example, a URI may be set by a dependent without a substantial impact on the security properties of the Manifest.<a href="#section-5.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="suit-dependency-resolution">
<section id="section-5.5">
        <h3 id="name-dependency-resolution">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-dependency-resolution" class="section-name selfRef">Dependency Resolution</a>
        </h3>
<p id="section-5.5-1">The Dependency Resolution Command Sequence is a container for the Commands needed to acquire and process the Dependencies of the current Manifest. All Dependency Manifests SHOULD be fetched before any Payload is fetched to ensure that all Manifests are available and authenticated before any of the (larger) Payloads are acquired.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="added-and-modified-commands">
<section id="section-5.6">
        <h3 id="name-added-and-modified-commands">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-added-and-modified-commands" class="section-name selfRef">Added and Modified Commands</a>
        </h3>
<p id="section-5.6-1">All Commands are modified in that they can also target Dependencies. However, Set Component Index has a larger modification.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Command Name</th>
              <th class="text-left" rowspan="1" colspan="1">Semantic of the Operation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Set Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">current.params[k] := v if not k in current.params for-each k,v in arg</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Process Dependency</td>
              <td class="text-left" rowspan="1" colspan="1">exec(current[common]); exec(current[current-segment])</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Dependency Integrity</td>
              <td class="text-left" rowspan="1" colspan="1">verify(current, current.params[image-digest])</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Is Dependency</td>
              <td class="text-left" rowspan="1" colspan="1">assert(current exists in Dependencies)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Unlink</td>
              <td class="text-left" rowspan="1" colspan="1">unlink(current)</td>
            </tr>
          </tbody>
        </table>
<div id="suit-directive-set-parameters">
<section id="section-5.6.1">
          <h4 id="name-suit-directive-set-paramete">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-suit-directive-set-paramete" class="section-name selfRef">suit-directive-set-parameters</a>
          </h4>
<p id="section-5.6.1-1">Similar to suit-directive-override-parameters, suit-directive-set-parameters allows the Manifest to configure behavior of future Directives by changing Parameters that are read by those Directives. Set Parameters is for use when Dependencies are used because it allows a Manifest to modify the behavior of its Dependencies.<a href="#section-5.6.1-1" class="pilcrow">¶</a></p>
<p id="section-5.6.1-2">Available Parameters are defined in <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>, section 8.4.8.<a href="#section-5.6.1-2" class="pilcrow">¶</a></p>
<p id="section-5.6.1-3">If a Parameter is already set, suit-directive-set-parameters will skip setting the Parameter to its argument. This allows dependent Manifests to change the behavior of a Manifest, a Dependency that wishes to enforce a specific value of a Parameter MAY use suit-directive-override-parameters instead.<a href="#section-5.6.1-3" class="pilcrow">¶</a></p>
<p id="section-5.6.1-4">suit-directive-set-parameters does not specify a reporting policy.<a href="#section-5.6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suit-directive-process-dependency">
<section id="section-5.6.2">
          <h4 id="name-suit-directive-process-depe">
<a href="#section-5.6.2" class="section-number selfRef">5.6.2. </a><a href="#name-suit-directive-process-depe" class="section-name selfRef">suit-directive-process-dependency</a>
          </h4>
<p id="section-5.6.2-1">Execute the Commands in the common section of the current Dependency, followed by the Commands in the equivalent section of the current Dependency. For example, if the current section is "Payload Fetch," this will execute "Common metadata" in the current Dependency, then "Payload Fetch" in the current Dependency. Once this is complete, the Command following suit-directive-process-dependency will be processed.<a href="#section-5.6.2-1" class="pilcrow">¶</a></p>
<p id="section-5.6.2-2">If the current Component index does not have an entry in the suit-dependencies map, then this Command MUST Abort.<a href="#section-5.6.2-2" class="pilcrow">¶</a></p>
<p id="section-5.6.2-3">If the current Component index has not been the target of a suit-condition-dependency-integrity, then this Command MUST Abort.<a href="#section-5.6.2-3" class="pilcrow">¶</a></p>
<p id="section-5.6.2-4">If the current Component is True, then this Directive applies to all Dependencies. If the current section is "Common metadata," then the Command sequence MUST Abort.<a href="#section-5.6.2-4" class="pilcrow">¶</a></p>
<p id="section-5.6.2-5">When SUIT_Process_Dependency completes, it forwards the last status code that occurred in the Dependency.<a href="#section-5.6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suit-condition-is-dependency">
<section id="section-5.6.3">
          <h4 id="name-suit-condition-is-dependenc">
<a href="#section-5.6.3" class="section-number selfRef">5.6.3. </a><a href="#name-suit-condition-is-dependenc" class="section-name selfRef">suit-condition-is-dependency</a>
          </h4>
<p id="section-5.6.3-1">Check whether the current Component index is present in the Dependency list. If the current Component is in the Dependency list, suit-condition-is-dependency succeeds. Otherwise, it fails. This can be used along with component-id = True to act on all Dependencies or on all non-Dependency Components. See <a href="#creating-manifests" class="auto internal xref">Section 8</a> for more details.<a href="#section-5.6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suit-condition-dependency-integrity">
<section id="section-5.6.4">
          <h4 id="name-suit-condition-dependency-i">
<a href="#section-5.6.4" class="section-number selfRef">5.6.4. </a><a href="#name-suit-condition-dependency-i" class="section-name selfRef">suit-condition-dependency-integrity</a>
          </h4>
<p id="section-5.6.4-1">Verify the integrity of a Dependency Manifest. When a Manifest Processor executes suit-condition-dependency-integrity, it performs the following operations:<a href="#section-5.6.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.6.4-2">
<li id="section-5.6.4-2.1">Verify the signature of the Manifest hash<a href="#section-5.6.4-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.6.4-2.2">Compare the Manifest hash to the provided hash<a href="#section-5.6.4-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.6.4-2.3">Verify the Manifest against the Manifest hash<a href="#section-5.6.4-2.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.6.4-3">If any of these steps fails, the Manifest Process MUST immediately Abort.<a href="#section-5.6.4-3" class="pilcrow">¶</a></p>
<p id="section-5.6.4-4">The Manifest Processor MAY cache the results of these operations for later use from the context of the current Manifest. The Manifest Processor MUST NOT use cached results from any other Manifest context. If the Manifest Processor caches the results of these checks, it MUST eliminate this cache if any Fetch, or Copy operation targets the Dependency Manifest's Component ID.<a href="#section-5.6.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="suit-directive-unlink">
<section id="section-5.6.5">
          <h4 id="name-suit-directive-unlink">
<a href="#section-5.6.5" class="section-number selfRef">5.6.5. </a><a href="#name-suit-directive-unlink" class="section-name selfRef">suit-directive-unlink</a>
          </h4>
<p id="section-5.6.5-1">A manifest processor that supports multiple independent root manifests
MUST support suit-directive-unlink. When a Component is no longer
needed, the Manifest processor unlinks the Component to inform the 
Manifest processor that it is no longer needed.<a href="#section-5.6.5-1" class="pilcrow">¶</a></p>
<p id="section-5.6.5-2">If a Manifest is no longer needed, the Manifest Processor unlinks it.
This causes the Manifest Processor to execute the suit-uninstall section
of the unlinked Manifest, after which it decrements the reference count
of the unlinked Manifest. The suit-uninstall section of a manifest
typically contains an unlink of all its dependencies and components.<a href="#section-5.6.5-2" class="pilcrow">¶</a></p>
<p id="section-5.6.5-3">All components, including Manifests must be unlinked before deletion 
or overwrite. If the
reference count of a component is non-zero, any command that alters
that component MUST cause an immediate ABORT. Affected commands are:<a href="#section-5.6.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.5-4.1">suit-directive-copy<a href="#section-5.6.5-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.5-4.2">suit-directive-fetch<a href="#section-5.6.5-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.5-4.3">suit-directive-write<a href="#section-5.6.5-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.5-5">The unlink Command decrements an implementation-defined reference counter. This reference counter MUST persist across restarts. The reference counter MUST NOT be decremented by a given Manifest more than once, and the Manifest processor must enforce this. The Manifest processor MAY choose to ignore an Unlink Directive depending on device policy.<a href="#section-5.6.5-5" class="pilcrow">¶</a></p>
<p id="section-5.6.5-6">When the reference counter of a Manifest reaches zero, the suit-uninstall Command sequence is invoked (see <a href="#suit-uninstall" class="auto internal xref">Section 6</a>).<a href="#section-5.6.5-6" class="pilcrow">¶</a></p>
<p id="section-5.6.5-7">suit-directive-unlink is OPTIONAL to implement in Manifest processors,
but Manifest processors that support multiple independent Root Manifests
MUST support suit-directive-unlink.<a href="#section-5.6.5-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="suit-uninstall">
<section id="section-6">
      <h2 id="name-uninstall">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-uninstall" class="section-name selfRef">Uninstall</a>
      </h2>
<p id="section-6-1">In some systems, particularly with multiple, independent, optional Components, it may be that there is a need to uninstall the Components that have been installed by a Manifest. Where this is expected, the uninstall Command sequence can provide the sequence needed to cleanly remove the Components defined by the Manifest and its Dependencies. In general, the suit-uninstall Command Sequence will contain primarily unlink Directives.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">WARNING: This can cause faults where there are loose Dependencies (e.g., version range matching, see <span>[<a href="#I-D.ietf-suit-update-management" class="cite xref">I-D.ietf-suit-update-management</a>]</span>), since a Component can be removed while it is depended upon by another Component. To avoid Dependency faults, a Manifest author MAY use explicit Dependencies where possible, or a Manifest processor MAY track references to loose Dependencies via reference counting in the same way as explicit Dependencies, as described in <a href="#suit-directive-unlink" class="auto internal xref">Section 5.6.5</a>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The suit-uninstall Command Sequence is not severable, since it must always be available to enable uninstalling.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="staging-and-installation">
<section id="section-7">
      <h2 id="name-staging-and-installation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-staging-and-installation" class="section-name selfRef">Staging and Installation</a>
      </h2>
<p id="section-7-1">In order to coordinate between download and installation in different trust domains, the Update Procedure defined in <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>, Section 8.4.6 is divided into two sub-procedures:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">
          <p id="section-7-2.1.1">The Staging Procedure: This procedure is responsible for dependency resolution and acquiring all payloads required for the Update to proceed. It is composed of two command sequences<a href="#section-7-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1.2.1">suit-dependency-resolution<a href="#section-7-2.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7-2.1.2.2">suit-payload-fetch<a href="#section-7-2.1.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="section-7-2.2">
          <p id="section-7-2.2.1">The Installation Procedure: This procedure is responsible for verifying staged components and installing them. It is composed of:<a href="#section-7-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.2.2.1">suit-candidate-verification<a href="#section-7-2.2.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7-2.2.2.2">suit-install<a href="#section-7-2.2.2.2" class="pilcrow">¶</a>
</li>
          </ul>
</li>
      </ul>
<p id="section-7-3">This extension is backwards compatible when used with a Manifest Processor that supports the Update Procedure but = does not support the Staging Procedure and Installation Procedure: the payload-fetch command sequence already contains suit-condition-image tests for each payload (see <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>, section 7.3) which means that images are already validated when suit-install is invoked. This makes suit-candidate-verification OPTIONAL to implement and OPTIONAL to parse.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The Staging and Installation Procedures are only required when Staging occurs in a different trust domain to Installation.<a href="#section-7-4" class="pilcrow">¶</a></p>
<div id="suit-candidate-verification">
<section id="section-7.1">
        <h3 id="name-suit-candidate-verification">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-suit-candidate-verification" class="section-name selfRef">suit-candidate-verification</a>
        </h3>
<p id="section-7.1-1">This command sequence is responsible for verifying that all elements of an update are present and correct prior to installation. This is only required when Installation occurs in a trust domain different from Staging, such as an installer invoked by the bootloader.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="creating-manifests">
<section id="section-8">
      <h2 id="name-creating-manifests">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-creating-manifests" class="section-name selfRef">Creating Manifests</a>
      </h2>
<p id="section-8-1">This section details a set of templates for creating Manifests. These templates explain which Parameters, Commands, and orders of Commands are necessary to achieve a stated goal.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="template-dependency">
<section id="section-8.1">
        <h3 id="name-dependency-template">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-dependency-template" class="section-name selfRef">Dependency Template</a>
        </h3>
<p id="section-8.1-1">The goal of the Dependency template is to obtain, verify, and process a Dependency Manifest as appropriate.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The following Commands are added to the shared sequence:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-3.2">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for digest (see Section 8.4.8.6 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>). Note that the digest MUST match the SUIT_Digest in the Dependency's suit-authentication-block (see Section 8.3 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>).<a href="#section-8.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-4">The following Commands are placed into the Dependency resolution sequence:<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-5.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-5.2">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for a URI (see Section 8.4.8.10 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-5.3">Fetch Directive (see Section 8.4.10.4 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-5.4">Dependency Integrity Condition (see <a href="#suit-condition-dependency-integrity" class="auto internal xref">Section 5.6.4</a>)<a href="#section-8.1-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-5.5">Process Dependency Directive (see <a href="#suit-directive-process-dependency" class="auto internal xref">Section 5.6.2</a>)<a href="#section-8.1-5.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-6">Then, the validate sequence contains the following operations:<a href="#section-8.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-7.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.1-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.2">Dependency Integrity Condition (see <a href="#suit-condition-dependency-integrity" class="auto internal xref">Section 5.6.4</a>)<a href="#section-8.1-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-7.3">Process Dependency Directive (see <a href="#suit-directive-process-dependency" class="auto internal xref">Section 5.6.2</a>)<a href="#section-8.1-7.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.1-8">If any Dependency is declared, the dependent MUST populate all Command sequences for the current Procedure (Update or Invoke).<a href="#section-8.1-8" class="pilcrow">¶</a></p>
<p id="section-8.1-9">NOTE: Any changes made to Parameters in a Dependency persist in the dependent.<a href="#section-8.1-9" class="pilcrow">¶</a></p>
<div id="integrated-dependencies">
<section id="section-8.1.1">
          <h4 id="name-integrated-dependencies">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-integrated-dependencies" class="section-name selfRef">Integrated Dependencies</a>
          </h4>
<p id="section-8.1.1-1">An implementer MAY choose to place a Dependency's Envelope in the Envelope of its dependent. The dependent Envelope key for the Dependency Envelope MUST be a text string. The URI for the Dependency MUST match the text string key of the dependent's Envelope key. It is RECOMMENDED to make the text string key a resolvable URI so that a Dependency Manifest that is removed from the Envelope can still be fetched.<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="template-encrypted-manifest">
<section id="section-8.2">
        <h3 id="name-encrypted-manifest-template">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-encrypted-manifest-template" class="section-name selfRef">Encrypted Manifest Template</a>
        </h3>
<p id="section-8.2-1">The goal of the Encrypted Manifest template is to fetch and decrypt a Manifest so that it can be used as a Dependency. To use an encrypted Manifest, create a plaintext dependent, and add the encrypted Manifest as a Dependency. The dependent can include very little information.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">NOTE: This template also requires the extensions defined in <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="cite xref">I-D.ietf-suit-firmware-encryption</a>]</span>.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">The following Commands are added to the shared sequence:<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-4.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-4.2">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for digest (see Section 8.4.8.6 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>). Note that the digest MUST match the SUIT_Digest in the Dependency's suit-authentication-block (see Section 8.3 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>).<a href="#section-8.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.2-5">The following operations are placed into the Dependency resolution block:<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-6.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-6.2">
            <p id="section-8.2-6.2.1">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for<a href="#section-8.2-6.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-6.2.2.1">URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.2-6.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-8.2-6.2.2.2">Encryption Info (See <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="cite xref">I-D.ietf-suit-firmware-encryption</a>]</span>)<a href="#section-8.2-6.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.2-6.3">Fetch Directive (see Section 8.4.10.4 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-6.4">Dependency Integrity Condition (see <a href="#suit-condition-dependency-integrity" class="auto internal xref">Section 5.6.4</a>)<a href="#section-8.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-6.5">Process Dependency Directive (see <a href="#suit-directive-process-dependency" class="auto internal xref">Section 5.6.2</a>)<a href="#section-8.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.2-7">Then, the validate block contains the following operations:<a href="#section-8.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2-8.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-8.2">Check Image Match Condition (see Section 8.4.9.2 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.2-8.3">Process Dependency Directive (see <a href="#suit-directive-process-dependency" class="auto internal xref">Section 5.6.2</a>)<a href="#section-8.2-8.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.2-9">A plaintext Manifest and its encrypted Dependency may also form a composite Manifest (<a href="#integrated-dependencies" class="auto internal xref">Section 8.1.1</a>).<a href="#section-8.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="template-override-encryption-info">
<section id="section-8.3">
        <h3 id="name-overriding-encryption-info-">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-overriding-encryption-info-" class="section-name selfRef">Overriding Encryption Info Template</a>
        </h3>
<p id="section-8.3-1">The goal of overriding the Encryption Info template is to separate the role of generating encrypted Payload and Encryption Info with Key-Encryption Key addressing Section 3 of <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="cite xref">I-D.ietf-suit-firmware-encryption</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">As an example, this template describes two manifests:
- The dependent Manifest created by the Distribution System contains Encryption Info, allowing the Device to generate the Content-Encryption Key.
- The dependency Manifest created by the Author contains Commands to decrypt the encrypted Payload using Encryption Info above and to validate the plaintext Payload with SUIT_Digest.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">NOTE: This template also requires the extensions defined in <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="cite xref">I-D.ietf-suit-firmware-encryption</a>]</span>.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">The following operations are placed into the Dependency resolution block of dependent Manifest:<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-5.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) pointing at dependency Manifest<a href="#section-8.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-5.2">
            <p id="section-8.3-5.2.1">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for<a href="#section-8.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-5.2.2.1">Image Digest (see Section 8.4.8.6 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.3-5.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-8.3-5.2.2.2">URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) of dependency Manifest<a href="#section-8.3-5.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-5.3">Fetch Directive (see Section 8.4.10.4 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.3-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-5.4">Dependency Integrity Condition (see <a href="#suit-condition-dependency-integrity" class="auto internal xref">Section 5.6.4</a>)<a href="#section-8.3-5.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-6">The following Commands are placed into the Fetch/Install block of dependent Manifest<a href="#section-8.3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-7.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) pointing at encrypted Payload<a href="#section-8.3-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-7.2">
            <p id="section-8.3-7.2.1">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for<a href="#section-8.3-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-7.2.2.1">URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.3-7.2.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-7.3">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) pointing at dependency Manifest<a href="#section-8.3-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-7.4">
            <p id="section-8.3-7.4.1">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for<a href="#section-8.3-7.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-7.4.2.1">Encryption Info (See <span>[<a href="#I-D.ietf-suit-firmware-encryption" class="cite xref">I-D.ietf-suit-firmware-encryption</a>]</span>)<a href="#section-8.3-7.4.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-7.5">Process Dependency Directive (see <a href="#suit-directive-process-dependency" class="auto internal xref">Section 5.6.2</a>)<a href="#section-8.3-7.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-8">The following Commands are placed into the same block of dependency Manifest:<a href="#section-8.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-9.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) pointing at encrypted Payload<a href="#section-8.3-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-9.2">Fetch Directive (see Section 8.4.10.4 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.3-9.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-9.3">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) pointing at to be decrypted Payload<a href="#section-8.3-9.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-9.4">
            <p id="section-8.3-9.4.1">Override Parameters Directive (see Section 8.4.10.3 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) for<a href="#section-8.3-9.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-9.4.2.1">Source Component (see Section 8.4.8.11 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) pointing at encrypted Payload<a href="#section-8.3-9.4.2.1" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-9.5">Copy Directive (see Section 8.4.10.5 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>) consuming the Encryption Info above<a href="#section-8.3-9.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-8.3-10">The Distribution System can Set the Parameter URI in the Fetch/Install block of dependent Manifest if it wants to overwrite the URI of encrypted Payload.<a href="#section-8.3-10" class="pilcrow">¶</a></p>
<p id="section-8.3-11">Because the Author and the Distribution System have different roles and MAY be separate entities, it is highly RECOMMENDED to leverage permissions (see Section 9 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>).
For example, The Device can protect itself from attacker who breaches the Distribution System by allowing only the Author's Manifest to modify the Component of (to be) decrypted Payload.<a href="#section-8.3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operating-on-multiple-components">
<section id="section-8.4">
        <h3 id="name-operating-on-multiple-compo">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-operating-on-multiple-compo" class="section-name selfRef">Operating on Multiple Components</a>
        </h3>
<p id="section-8.4-1">In order to produce compact encoding, it is efficient to perform operations on multiple Components simultaneously. Because Dependency Manifests and Component Images are processed at different times, there is a mechanism to distinguish between these elements: suit-condition-is-dependency. This can be used with suit-directive-try-each to perform operations just on Dependency Manifests or just on Component Images.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">For example, to fetch all Dependency Manifests, the following Commands are added to the Dependency resolution block:<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-3.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-3.2">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for a URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-3.3">Set Component Index Directive, with argument "True" (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-3.4">
            <p id="section-8.4-3.4.1">Try Each Directive<a href="#section-8.4-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-3.4.2.1">
                <p id="section-8.4-3.4.2.1.1">Sequence 0<a href="#section-8.4-3.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-3.4.2.1.2.1">Condition Is Dependency Manifest<a href="#section-8.4-3.4.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-8.4-3.4.2.1.2.2">Fetch<a href="#section-8.4-3.4.2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-8.4-3.4.2.1.2.3">Dependency Integrity Condition (see <a href="#suit-condition-dependency-integrity" class="auto internal xref">Section 5.6.4</a>)<a href="#section-8.4-3.4.2.1.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-8.4-3.4.2.1.2.4">Process Dependency<a href="#section-8.4-3.4.2.1.2.4" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-8.4-3.4.2.2">Sequence 1 (Empty; no Commands, succeeds immediately)<a href="#section-8.4-3.4.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-8.4-4">Another example is to fetch and validate all Component Images. The Image fetch sequence contains the following Commands:<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-5.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-5.2">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for a URI (see Section 8.4.8.9 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-5.3">Set Component Index Directive, with argument "True" (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-5.4">
            <p id="section-8.4-5.4.1">Try Each Directive<a href="#section-8.4-5.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-5.4.2.1">
                <p id="section-8.4-5.4.2.1.1">Sequence 0<a href="#section-8.4-5.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-5.4.2.1.2.1">Condition Is Dependency Manifest<a href="#section-8.4-5.4.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-8.4-5.4.2.1.2.2">Process Dependency<a href="#section-8.4-5.4.2.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-8.4-5.4.2.2">
                <p id="section-8.4-5.4.2.2.1">Sequence 1<a href="#section-8.4-5.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-5.4.2.2.2.1">Fetch<a href="#section-8.4-5.4.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-8.4-5.4.2.2.2.2">Condition Image Match<a href="#section-8.4-5.4.2.2.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
</li>
        </ul>
<p id="section-8.4-6">When some Components are "installed" or "loaded" it is more productive to use lists of Component indices rather than Component Index = True. For example, to install several Components, the following Commands should be placed in the Image Install Sequence:<a href="#section-8.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-7.1">Set Component Index Directive (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-7.2">Set Parameters Directive (see <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>) for the Source Component (see Section 8.4.8.11 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-7.3">Set Component Index Directive, with argument containing list of destination Component indices (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-7.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-7.4">Copy<a href="#section-8.4-7.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-7.5">Set Component Index Directive, with argument containing list Dependency Component indices (see Section 8.4.10.1 of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span>)<a href="#section-8.4-7.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.4-7.6">Process Dependency<a href="#section-8.4-7.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">IANA is requested to allocate the following numbers in the listed registries created by draft-ietf-suit-manifest:<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="suit-envelope-elements">
<section id="section-9.1">
        <h3 id="name-suit-envelope-elements">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-suit-envelope-elements" class="section-name selfRef">SUIT Envelope Elements</a>
        </h3>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">Dependency Resolution</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-dependency-resolution" class="auto internal xref">Section 5.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">Candidate Verification</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-candidate-verification" class="auto internal xref">Section 7.1</a>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="suit-manifest-elements">
<section id="section-9.2">
        <h3 id="name-suit-manifest-elements">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-suit-manifest-elements" class="section-name selfRef">SUIT Manifest Elements</a>
        </h3>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Manifest Component ID</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#manifest-id" class="auto internal xref">Section 5.2.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">Dependency Resolution</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-dependency-resolution" class="auto internal xref">Section 5.5</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">24</td>
              <td class="text-left" rowspan="1" colspan="1">Uninstall</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-uninstall" class="auto internal xref">Section 6</a>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="suit-common-elements">
<section id="section-9.3">
        <h3 id="name-suit-common-elements">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-suit-common-elements" class="section-name selfRef">SUIT Common Elements</a>
        </h3>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Dependencies</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#SUIT_Dependencies" class="auto internal xref">Section 5.2.2</a>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="suit-commands">
<section id="section-9.4">
        <h3 id="name-suit-commands">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-suit-commands" class="section-name selfRef">SUIT Commands</a>
        </h3>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">Dependency Integrity</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-condition-dependency-integrity" class="auto internal xref">Section 5.6.4</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">Is Dependency</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-condition-is-dependency" class="auto internal xref">Section 5.6.3</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">Process Dependency</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-process-dependency" class="auto internal xref">Section 5.6.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">19</td>
              <td class="text-left" rowspan="1" colspan="1">Set Parameters</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-set-parameters" class="auto internal xref">Section 5.6.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">33</td>
              <td class="text-left" rowspan="1" colspan="1">Unlink</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#suit-directive-unlink" class="auto internal xref">Section 5.6.5</a>
</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This document is about a Manifest format protecting and describing how to retrieve, install, and invoke Images and as such it is part of a larger solution for delivering software updates to devices. A detailed security treatment can be found in the architecture <span>[<a href="#RFC9019" class="cite xref">RFC9019</a>]</span> and in the information model <span>[<a href="#RFC9124" class="cite xref">RFC9124</a>]</span> documents.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-suit-manifest">[I-D.ietf-suit-manifest]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Zandberg, K.</span>, and <span class="refAuthor">O. Rønningstad</span>, <span class="refTitle">"A Concise Binary Object Representation (CBOR)-based Serialization Format for the Software Updates for Internet of Things (SUIT) Manifest"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-manifest-25</span>, <time datetime="2024-02-05" class="refDate">5 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-suit-manifest-25">https://datatracker.ietf.org/doc/html/draft-ietf-suit-manifest-25</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6024">[RFC6024]</dt>
        <dd>
<span class="refAuthor">Reddy, R.</span> and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Trust Anchor Management Requirements"</span>, <span class="seriesInfo">RFC 6024</span>, <span class="seriesInfo">DOI 10.17487/RFC6024</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6024">https://www.rfc-editor.org/rfc/rfc6024</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7228">https://www.rfc-editor.org/rfc/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8747">https://www.rfc-editor.org/rfc/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9019">[RFC9019]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">M. Meriac</span>, <span class="refTitle">"A Firmware Update Architecture for Internet of Things"</span>, <span class="seriesInfo">RFC 9019</span>, <span class="seriesInfo">DOI 10.17487/RFC9019</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9019">https://www.rfc-editor.org/rfc/rfc9019</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9124">[RFC9124]</dt>
      <dd>
<span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">H. Birkholz</span>, <span class="refTitle">"A Manifest Information Model for Firmware Updates in Internet of Things (IoT) Devices"</span>, <span class="seriesInfo">RFC 9124</span>, <span class="seriesInfo">DOI 10.17487/RFC9124</span>, <time datetime="2022-01" class="refDate">January 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9124">https://www.rfc-editor.org/rfc/rfc9124</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-suit-firmware-encryption">[I-D.ietf-suit-firmware-encryption]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Moran, B.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">K. Takayama</span>, <span class="refTitle">"Encrypted Payloads in SUIT Manifests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-firmware-encryption-19</span>, <time datetime="2024-03-03" class="refDate">3 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-suit-firmware-encryption-19">https://datatracker.ietf.org/doc/html/draft-ietf-suit-firmware-encryption-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-suit-update-management">[I-D.ietf-suit-update-management]</dt>
        <dd>
<span class="refAuthor">Moran, B.</span> and <span class="refAuthor">K. Takayama</span>, <span class="refTitle">"Update Management Extensions for Software Updates for Internet of Things (SUIT) Manifests"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-suit-update-management-06</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-suit-update-management-06">https://datatracker.ietf.org/doc/html/draft-ietf-suit-update-management-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-teep-architecture">[I-D.ietf-teep-architecture]</dt>
      <dd>
<span class="refAuthor">Pei, M.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">D. M. Wheeler</span>, <span class="refTitle">"Trusted Execution Environment Provisioning (TEEP) Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-teep-architecture-19</span>, <time datetime="2022-10-24" class="refDate">24 October 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-teep-architecture-19">https://datatracker.ietf.org/doc/html/draft-ietf-teep-architecture-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="full-cddl">
<section id="appendix-A">
      <h2 id="name-a-full-cddl">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-a-full-cddl" class="section-name selfRef">A. Full CDDL</a>
      </h2>
<p id="appendix-A-1">To be valid, the following CDDL MUST be appended to the SUIT Manifest CDDL. The SUIT CDDL is defined in Appendix A of <span>[<a href="#I-D.ietf-suit-manifest" class="cite xref">I-D.ietf-suit-manifest</a>]</span><a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="breakable lang-CDDL sourcecode" id="appendix-A-2">
<pre>
$$SUIT_Envelope_Extensions //=
    (suit-delegation =&gt; bstr .cbor SUIT_Delegation)
$$SUIT_Envelope_Extensions //= (
    suit-integrated-dependency-key =&gt; bstr .cbor SUIT_Envelope)

SUIT_Delegation = [ + [ + bstr .cbor CWT ] ]

CWT = SUIT_Authentication_Block

$$SUIT_Manifest_Extensions //=
    (suit-manifest-component-id =&gt; SUIT_Component_Identifier)

$$SUIT_severable-members-extensions //=
    (suit-dependency-resolution =&gt; bstr .cbor SUIT_Command_Sequence)

$$SUIT_severable-members-extensions //=
    (suit-candidate-verification =&gt; bstr .cbor SUIT_Command_Sequence)

$$unseverable-manifest-member-extensions //=
    (suit-uninstall =&gt; bstr .cbor SUIT_Command_Sequence)

suit-integrated-dependency-key = tstr

$$severable-manifest-members-choice-extensions //= (
    suit-dependency-resolution =&gt;
        bstr .cbor SUIT_Command_Sequence / SUIT_Digest)

$$SUIT_Common-extensions //= (
    suit-dependencies =&gt; SUIT_Dependencies
)
SUIT_Dependencies = {
    + uint =&gt; SUIT_Dependency_Metadata
}
SUIT_Dependency_Metadata = {
    ? suit-dependency-prefix =&gt; SUIT_Component_Identifier
    * $$SUIT_Dependency_Extensions
}

SUIT_Condition //= (
    suit-condition-dependency-integrity, SUIT_Rep_Policy)
SUIT_Condition //= (
    suit-condition-is-dependency, SUIT_Rep_Policy)

SUIT_Directive //= (
    suit-directive-process-dependency, SUIT_Rep_Policy)
SUIT_Directive //= (suit-directive-set-parameters,
    {+ $$SUIT_Parameters})
SUIT_Directive //= (
    suit-directive-unlink, SUIT_Rep_Policy)

suit-manifest-component-id = 5

suit-delegation = 1
suit-dependency-resolution = 15
suit-candidate-verification = 18
suit-uninstall = 24

suit-dependencies = 1

suit-dependency-prefix = 1

suit-condition-dependency-integrity     = 7
suit-condition-is-dependency            = 8
suit-directive-process-dependency       = 11
suit-directive-set-parameters           = 19
suit-directive-unlink                   = 33

</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-B">
      <h2 id="name-b-examples">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-b-examples" class="section-name selfRef">B. Examples</a>
      </h2>
<p id="appendix-B-1">The following examples demonstrate a small subset of the functionalities in this document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The examples are signed using the following ECDSA secp256r1 key:<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-3">
<pre>
-----BEGIN PRIVATE KEY-----
MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgApZYjZCUGLM50VBC
CjYStX+09jGmnyJPrpDLTz/hiXOhRANCAASEloEarguqq9JhVxie7NomvqqL8Rtv
P+bitWWchdvArTsfKktsCYExwKNtrNHXi9OB3N+wnAUtszmR23M4tKiW
-----END PRIVATE KEY-----
</pre><a href="#appendix-B-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B-4">The corresponding public key can be used to verify these examples:<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-5">
<pre>
-----BEGIN PUBLIC KEY-----
MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEhJaBGq4LqqvSYVcYnuzaJr6qi/Eb
bz/m4rVlnIXbwK07HypLbAmBMcCjbazR14vTgdzfsJwFLbM5kdtzOLSolg==
-----END PUBLIC KEY-----
</pre><a href="#appendix-B-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B-6">Each example uses SHA256 as the digest function.<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<div id="example-0-process-dependency">
<section id="appendix-B.1">
        <h3 id="name-example-0-process-dependenc">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-example-0-process-dependenc" class="section-name selfRef">Example 0: Process Dependency</a>
        </h3>
<p id="appendix-B.1-1">This example uses functionalities:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">manifest component id<a href="#appendix-B.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-2.2">dependency resolution<a href="#appendix-B.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.1-2.3">process dependency<a href="#appendix-B.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="appendix-B.1-3">
<pre>
/ SUIT_Envelope_Tagged / 107({
  / authentication-wrapper / 2: &lt;&lt; [
    &lt;&lt; [
      / digest-algorithm-id: / -16 / SHA256 /,
      / digest-bytes: /
        h'4874ADC80A9128A2B2057F5FE59C45F8ED10A9BF9C5308FCF951B8BBAF434B95'
    ] &gt;&gt;,
    &lt;&lt; / COSE_Sign1_Tagged / 18([
      / protected: / &lt;&lt; {
        / algorithm-id / 1: -7 / ES256 /
      } &gt;&gt;,
      / unprotected: / {},
      / payload: / null,
      / signature: /
        h'C257E23A34960BE215BB9B927A5A3CEEDD675DFD81AE6E55A66FDD2209886889
          1DF42D71ADB962A64CC008AEF9465DA2153CCF383F00B505F079DB540F64B916'
    ]) &gt;&gt;
  ] &gt;&gt;,
  / manifest / 3: &lt;&lt; {
    / manifest-version / 1: 1,
    / manifest-sequence-number / 2: 0,
    / common / 3: &lt;&lt; {
      / dependencies / 1: {
        / component-index / 1: {
          / dependency-prefix / 1: [
            'dependent.suit'
          ]
        }
      },
      / components / 2: [
        [
          '10'
        ]
      ]
    } &gt;&gt;,
    / manifest-component-id / 5: [
      'depending.suit'
    ],
    / invoke / 9: &lt;&lt; [
      / directive-set-component-index / 12, 0,
      / directive-override-parameters / 20, {
        / parameter-invoke-args / 23: 'cat 00 10'
      },
      / directive-invoke / 23, 15
    ] &gt;&gt;,
    / dependency-resolution / 15: &lt;&lt; [
      / directive-set-component-index / 12, 1,
      / directive-override-parameters / 20, {
        / parameter-image-digest / 3: &lt;&lt; [
          / digest-algorithm-id: / -16 / SHA256 /,
          / digest-bytes: /
            h'6C86246B90D644F021671F6D42523B2CB5E156F764BE618AA46BFCD0DB23E768'
        ] &gt;&gt;,
        / parameter-image-size / 14: 352,
        / parameter-uri / 21: "http://example.com/dependent.suit"
      },
      / directive-fetch / 21, 2,
      / condition-image-match / 3, 15
    ] &gt;&gt;,
    / install / 17: &lt;&lt; [
      / directive-set-component-index / 12, 1,
      / directive-override-parameters / 20, {
        / parameter-image-digest / 3: &lt;&lt; [
          / digest-algorithm-id: / -16 / SHA256 /,
          / digest-bytes: /
            h'6EA128D7BB19B86F77C4227F2A29F22026A41958ACC45CC0A35BA388B13E2F51'
        ] &gt;&gt;
      },
      / condition-dependency-integrity / 7, 15,
      / directive-process-dependency / 11, 0,

      / directive-set-component-index / 12, 0,
      / directive-override-parameters / 20, {
        / parameter-content / 18: ' in multiple trust domains'
      },
      / directive-write / 18, 15
    ] &gt;&gt;
  } &gt;&gt;
})
</pre><a href="#appendix-B.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-4">Total size of Envelope with COSE authentication object:  374<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.1-5">Envelope with COSE authentication object:<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-6">
<pre>
D86BA2025873825824822F58204874ADC80A9128A2B2057F5FE59C45F8ED
10A9BF9C5308FCF951B8BBAF434B95584AD28443A10126A0F65840C257E2
3A34960BE215BB9B927A5A3CEEDD675DFD81AE6E55A66FDD22098868891D
F42D71ADB962A64CC008AEF9465DA2153CCF383F00B505F079DB540F64B9
160358FAA70101020003581CA201A101A101814E646570656E64656E742E
7375697402818142313005814E646570656E64696E672E73756974095286
0C0014A11749636174203030203130170F0F5858880C0114A3035824822F
58206C86246B90D644F021671F6D42523B2CB5E156F764BE618AA46BFCD0
DB23E7680E190160157821687474703A2F2F6578616D706C652E636F6D2F
646570656E64656E742E737569741502030F1158538E0C0114A103582482
2F58206EA128D7BB19B86F77C4227F2A29F22026A41958ACC45CC0A35BA3
88B13E2F51070F0B000C0014A112581A20696E206D756C7469706C652074
7275737420646F6D61696E73120F
</pre><a href="#appendix-B.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-1-integrated-dependency">
<section id="appendix-B.2">
        <h3 id="name-example-1-integrated-depend">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-example-1-integrated-depend" class="section-name selfRef">Example 1: Integrated Dependency</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">manifest component id<a href="#appendix-B.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.2">dependency resolution<a href="#appendix-B.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.3">process dependency<a href="#appendix-B.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-B.2-1.4">integrated dependency<a href="#appendix-B.2-1.4" class="pilcrow">¶</a>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="appendix-B.2-2">
<pre>
/ SUIT_Envelope_Tagged / 107({
  / authentication-wrapper / 2: &lt;&lt; [
    &lt;&lt; [
      / digest-algorithm-id: / -16 / SHA256 /,
      / digest-bytes: /
        h'318EAD5F671A6D2593D7ADB7B6CCADC49F72704507004F297A25AF16A48A2111'
    ] &gt;&gt;,
    &lt;&lt; / COSE_Sign1_Tagged / 18([
      / protected: / &lt;&lt; {
        / algorithm-id / 1: -7 / ES256 /
      } &gt;&gt;,
      / unprotected: / {},
      / payload: / null,
      / signature: /
        h'287D5AAB44D08A34954663942B2732825426893ACD735BF3A79B8B5B38EC3C99
          50D917D72D5586867C8FF58CF5827B0C2B94952359C3971DBF202B0774627DC3'
    ]) &gt;&gt;
  ] &gt;&gt;,
  / manifest / 3: &lt;&lt; {
    / manifest-version / 1: 1,
    / manifest-sequence-number / 2: 0,
    / common / 3: &lt;&lt; {
      / dependencies / 1: {
        / component-index / 1: {
          / dependency-prefix / 1: [
            'dependent.suit'
          ]
        }
      },
      / components / 2: [
        [
          '10'
        ]
      ]
    } &gt;&gt;,
    / manifest-component-id / 5: [
      'depending.suit'
    ],
    / invoke / 9: &lt;&lt; [
      / directive-set-component-index / 12, 0,
      / directive-override-parameters / 20, {
        / parameter-invoke-args / 23: 'cat 00 10'
      },
      / directive-invoke / 23, 15
    ] &gt;&gt;,
    / dependency-resolution / 15: &lt;&lt; [
      / directive-set-component-index / 12, 1,
      / directive-override-parameters / 20, {
        / parameter-image-digest / 3: &lt;&lt; [
          / digest-algorithm-id: / -16 / SHA256 /,
          / digest-bytes: /
            h'6C86246B90D644F021671F6D42523B2CB5E156F764BE618AA46BFCD0DB23E768'
        ] &gt;&gt;,
        / parameter-image-size / 14: 352,
        / parameter-uri / 21: "#dependent.suit"
      },
      / directive-fetch / 21, 2,
      / condition-image-match / 3, 15
    ] &gt;&gt;,
    / install / 17: &lt;&lt; [
      / directive-set-component-index / 12, 1,
      / directive-process-dependency / 11, 0,

      / directive-set-component-index / 12, 0,
      / directive-override-parameters / 20, {
        / parameter-content / 18: ' in multiple trust domains'
      },
      / directive-write / 18, 15
    ] &gt;&gt;
  } &gt;&gt;,
  / NOTE: Example 0 /
  "#dependent.suit":
    h'D86BA301589E8181589AD28443A10126A0584FA108A101A4010220012158200E
      908AA8F066DB1F084E0C3652C63952BD99F2A5BDB22F9E01367AAD03ABA68B22
      582077DA1BD8AC4F0CB490BA210648BF79AB164D49AD3551D71D314B2749EE42
      D29A5840FB2D5ACF66B9C8573CE92E13BFB8D113F798715CC10B5A0010B11925
      C155E7245A64E131073B87AC50CAC71650A21315B82D06CA2298CD1A95519AAE
      4C4B5315025874835824822F58206EA128D7BB19B86F77C4227F2A29F22026A4
      1958ACC45CC0A35BA388B13E2F51584AD28443A10126A0F6584099F949043701
      D7BDBA38904A0B49F004DED6B64A4900DECA5C66AE8A9EBA913576DEF136B74E
      A89C14FA64624DBD33B4C0BB41C153CA51548C73FF71A2BAF27440035842A601
      0102000347A102818142303005814E646570656E64656E742E73756974094D84
      14A11746636174203030170F11528414A1124B68656C6C6F20776F726C64120F'
})
</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-3">Total size of Envelope with COSE authentication object:  683<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<p id="appendix-B.2-4">Envelope with COSE authentication object:<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-5">
<pre>
D86BA3025873825824822F5820318EAD5F671A6D2593D7ADB7B6CCADC49F
72704507004F297A25AF16A48A2111584AD28443A10126A0F65840287D5A
AB44D08A34954663942B2732825426893ACD735BF3A79B8B5B38EC3C9950
D917D72D5586867C8FF58CF5827B0C2B94952359C3971DBF202B0774627D
C30358BCA70101020003581CA201A101A101814E646570656E64656E742E
7375697402818142313005814E646570656E64696E672E73756974095286
0C0014A11749636174203030203130170F0F5845880C0114A3035824822F
58206C86246B90D644F021671F6D42523B2CB5E156F764BE618AA46BFCD0
DB23E7680E190160156F23646570656E64656E742E737569741502030F11
58288A0C010B000C0014A112581A20696E206D756C7469706C6520747275
737420646F6D61696E73120F6F23646570656E64656E742E737569745901
60D86BA301589E8181589AD28443A10126A0584FA108A101A40102200121
58200E908AA8F066DB1F084E0C3652C63952BD99F2A5BDB22F9E01367AAD
03ABA68B22582077DA1BD8AC4F0CB490BA210648BF79AB164D49AD3551D7
1D314B2749EE42D29A5840FB2D5ACF66B9C8573CE92E13BFB8D113F79871
5CC10B5A0010B11925C155E7245A64E131073B87AC50CAC71650A21315B8
2D06CA2298CD1A95519AAE4C4B5315025874835824822F58206EA128D7BB
19B86F77C4227F2A29F22026A41958ACC45CC0A35BA388B13E2F51584AD2
8443A10126A0F6584099F949043701D7BDBA38904A0B49F004DED6B64A49
00DECA5C66AE8A9EBA913576DEF136B74EA89C14FA64624DBD33B4C0BB41
C153CA51548C73FF71A2BAF27440035842A6010102000347A10281814230
3005814E646570656E64656E742E73756974094D8414A117466361742030
30170F11528414A1124B68656C6C6F20776F726C64120F
</pre><a href="#appendix-B.2-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brendan Moran</span></div>
<div dir="auto" class="left"><span class="org">Arm Limited</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:brendan.moran.ietf@gmail.com" class="email">brendan.moran.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ken Takayama</span></div>
<div dir="auto" class="left"><span class="org">SECOM CO., LTD.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ken.takayama.ietf@gmail.com" class="email">ken.takayama.ietf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
